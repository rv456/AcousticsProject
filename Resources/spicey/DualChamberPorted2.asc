Version 4
SHEET 1 880 1084
WIRE -1712 -640 -1712 -672
WIRE -1712 -512 -1712 -560
WIRE -1712 -496 -1712 -512
WIRE -1664 -672 -1712 -672
WIRE -1552 -672 -1584 -672
WIRE -1536 -672 -1552 -672
WIRE -1488 -512 -1712 -512
WIRE -1360 -672 -1376 -672
WIRE -1360 -672 -1360 -768
WIRE -1344 -768 -1360 -768
WIRE -1344 -672 -1360 -672
WIRE -1248 -768 -1264 -768
WIRE -1248 -672 -1264 -672
WIRE -1248 -672 -1248 -768
WIRE -1216 -672 -1248 -672
WIRE -1216 -640 -1216 -672
WIRE -1216 -512 -1408 -512
WIRE -1216 -512 -1216 -560
WIRE -1104 -320 -1104 -496
WIRE -1104 -208 -1104 -240
WIRE -1104 64 -1104 -96
WIRE -1104 192 -1104 144
WIRE -1072 -704 -1072 -752
WIRE -1072 -608 -1072 -624
WIRE -1072 -576 -1072 -608
WIRE -1024 -496 -1104 -496
WIRE -1024 -416 -1024 -496
WIRE -1024 -208 -1104 -208
WIRE -1024 -208 -1024 -336
WIRE -1024 -96 -1104 -96
WIRE -1024 -16 -1024 -96
WIRE -1024 192 -1104 192
WIRE -1024 192 -1024 64
WIRE -976 -752 -1072 -752
WIRE -928 -608 -1072 -608
WIRE -880 -496 -1024 -496
WIRE -880 -416 -880 -496
WIRE -880 -208 -1024 -208
WIRE -880 -208 -880 -336
WIRE -880 -96 -1024 -96
WIRE -880 -16 -880 -96
WIRE -880 192 -1024 192
WIRE -880 192 -880 64
WIRE -864 -752 -896 -752
WIRE -768 -752 -784 -752
WIRE -768 -208 -880 -208
WIRE -768 192 -880 192
WIRE -752 -496 -880 -496
WIRE -752 -480 -752 -496
WIRE -752 -384 -752 -416
WIRE -752 -96 -880 -96
WIRE -752 -80 -752 -96
WIRE -752 16 -752 -16
WIRE -672 -752 -704 -752
WIRE -672 -720 -672 -752
WIRE -672 -608 -848 -608
WIRE -672 -608 -672 -640
WIRE -656 400 -656 384
WIRE -656 496 -656 480
WIRE -656 512 -656 496
WIRE -624 -496 -752 -496
WIRE -624 -384 -752 -384
WIRE -624 -384 -624 -416
WIRE -624 -368 -624 -384
WIRE -624 -208 -688 -208
WIRE -624 -208 -624 -288
WIRE -624 -96 -752 -96
WIRE -624 16 -752 16
WIRE -624 16 -624 -16
WIRE -624 32 -624 16
WIRE -624 192 -688 192
WIRE -624 192 -624 112
WIRE -608 384 -656 384
WIRE -608 496 -656 496
WIRE -608 496 -608 384
WIRE -592 -208 -624 -208
WIRE -592 192 -624 192
WIRE -576 -496 -624 -496
WIRE -576 -96 -624 -96
WIRE -464 -496 -496 -496
WIRE -464 -432 -464 -496
WIRE -464 -304 -464 -352
WIRE -464 -208 -512 -208
WIRE -464 -208 -464 -224
WIRE -432 -496 -464 -496
WIRE -432 -144 -432 -496
WIRE -432 -96 -496 -96
WIRE -432 -32 -432 -96
WIRE -432 96 -432 48
WIRE -432 192 -512 192
WIRE -432 192 -432 176
WIRE -368 -96 -432 -96
WIRE -368 -16 -368 -96
WIRE -368 192 -432 192
WIRE -368 192 -368 48
WIRE -368 208 -368 192
WIRE -352 400 -352 384
WIRE -352 496 -352 480
WIRE -352 512 -352 496
WIRE -336 -496 -432 -496
WIRE -336 -416 -336 -496
WIRE -336 -208 -464 -208
WIRE -336 -208 -336 -352
WIRE -304 -496 -336 -496
WIRE -304 -96 -368 -96
WIRE -304 384 -352 384
WIRE -304 496 -352 496
WIRE -304 496 -304 384
WIRE -240 -208 -336 -208
WIRE -240 -192 -240 -208
WIRE -208 -496 -224 -496
WIRE -192 -496 -208 -496
WIRE -192 -144 -432 -144
WIRE -192 -96 -224 -96
WIRE -192 -96 -192 -144
WIRE -176 -208 -240 -208
WIRE -80 -496 -112 -496
WIRE -48 -496 -80 -496
WIRE -48 -400 -48 -416
WIRE -48 -208 -96 -208
WIRE -48 -208 -48 -320
WIRE 0 -208 -48 -208
WIRE 48 144 48 112
WIRE 48 256 48 224
WIRE 48 480 48 352
WIRE 48 608 48 560
WIRE 64 -496 -48 -496
WIRE 64 -416 -48 -416
WIRE 64 -416 64 -432
WIRE 128 112 48 112
WIRE 128 352 48 352
WIRE 128 352 128 112
WIRE 144 -496 64 -496
WIRE 144 -432 144 -496
WIRE 144 -208 80 -208
WIRE 144 -208 144 -352
WIRE 192 -48 192 -80
WIRE 192 112 128 112
WIRE 192 112 192 32
WIRE 208 112 192 112
WIRE 208 320 208 112
WIRE 208 448 208 400
WIRE 272 -496 144 -496
WIRE 272 -416 272 -496
WIRE 272 -208 144 -208
WIRE 272 -208 272 -336
WIRE 288 -80 192 -80
WIRE 288 -48 288 -80
WIRE 288 112 208 112
WIRE 288 336 288 112
WIRE 352 -496 272 -496
WIRE 352 -352 352 -496
WIRE 352 -208 272 -208
WIRE 352 -208 352 -272
WIRE 384 336 288 336
WIRE 384 416 384 336
WIRE 384 544 384 496
WIRE 400 112 288 112
WIRE 400 160 400 112
WIRE 400 272 400 240
FLAG -1712 -496 0
FLAG -1072 -576 0
FLAG -240 -192 0
FLAG -80 -496 Pf
FLAG -1552 -672 In
FLAG -656 512 0
FLAG -352 512 0
FLAG -208 -496 Pb
FLAG -368 208 0
FLAG 208 448 0
FLAG 400 272 0
FLAG 48 256 0
FLAG 288 -48 0
FLAG 384 544 0
FLAG 48 608 0
SYMBOL voltage -1712 -656 R0
WINDOW 3 24 44 Left 0
WINDOW 123 -135 99 Left 0
WINDOW 39 0 0 Left 0
WINDOW 0 -59 15 Left 0
SYMATTR Value ""
SYMATTR Value2 AC 2.828 0
SYMATTR InstName Vin
SYMBOL res -1440 -688 R90
WINDOW 0 0 56 VBottom 0
WINDOW 3 32 56 VTop 0
SYMATTR InstName Re_
SYMATTR Value {Re}
SYMBOL ind -1360 -688 R90
WINDOW 0 5 56 VBottom 0
WINDOW 3 32 56 VTop 0
SYMATTR InstName Le_
SYMATTR Value {Le}
SYMBOL voltage -1392 -512 R90
WINDOW 0 -32 56 VBottom 0
WINDOW 3 32 56 VTop 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V_Isensor
SYMATTR Value ""
SYMATTR Value2 AC 0
SYMBOL h -1216 -656 R0
WINDOW 3 24 44 Invisible 0
SYMATTR Value V_uSensor
SYMATTR InstName BLu
SYMATTR Value2 {Bl}
SYMBOL h -1072 -720 R0
WINDOW 0 5 8 Left 0
WINDOW 3 24 104 Invisible 0
SYMATTR InstName Bli
SYMATTR Value V_ISensor
SYMATTR Value2 {BL}
SYMBOL ind -880 -768 R90
WINDOW 0 5 56 VBottom 0
WINDOW 3 32 56 VTop 0
SYMATTR InstName Mmd_
SYMATTR Value {Mmd}
SYMBOL res -768 -768 R90
WINDOW 0 0 56 VBottom 0
WINDOW 3 32 56 VTop 0
SYMATTR InstName Rms_
SYMATTR Value {Rms}
SYMBOL cap -704 -768 R90
WINDOW 0 0 32 VBottom 0
WINDOW 3 32 32 VTop 0
SYMATTR InstName Cms_
SYMATTR Value {Cms}
SYMBOL h -672 -736 R0
WINDOW 3 24 104 Invisible 0
SYMATTR Value Pf
SYMATTR InstName SdPd
SYMATTR Prefix E
SYMATTR Value2 Pb
SYMATTR SpiceLine {Sd}
SYMBOL voltage -832 -608 R90
WINDOW 0 -32 56 VBottom 0
WINDOW 3 32 56 VTop 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V_uSensor
SYMATTR Value ""
SYMATTR Value2 AC 0
SYMBOL f -192 -496 R270
WINDOW 3 24 88 Invisible 0
SYMATTR Value V_uSensor
SYMATTR InstName Sdu
SYMATTR Value2 {Sd}
SYMBOL res -64 -512 R0
SYMATTR InstName Ra1_
SYMATTR Value {Ra1}
SYMBOL res -64 -416 R0
SYMATTR InstName Ra2_
SYMATTR Value {Ra2}
SYMBOL cap 48 -496 R0
SYMATTR InstName Ca1_
SYMATTR Value {Ca1}
SYMBOL ind 128 -448 R0
SYMATTR InstName Ma1_
SYMATTR Value {Ma1}
SYMBOL ind -1248 -688 R90
WINDOW 0 5 56 VBottom 0
WINDOW 3 32 56 VTop 0
SYMATTR InstName Lep_
SYMATTR Value {Lep}
SYMBOL res -1360 -752 R270
WINDOW 0 32 56 VTop 0
WINDOW 3 0 56 VBottom 0
SYMATTR InstName Rep_
SYMATTR Value {Rep}
SYMBOL res -1680 -656 R270
WINDOW 0 32 56 VTop 0
WINDOW 3 0 56 VBottom 0
SYMATTR InstName Rsource
SYMATTR Value 0.1
SYMBOL voltage -80 -208 R90
WINDOW 0 -32 56 VBottom 0
WINDOW 3 32 56 VTop 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V_WVUSensor
SYMATTR Value ""
SYMATTR Value2 AC 0
SYMBOL bi -656 480 R180
WINDOW 0 24 88 Left 0
WINDOW 3 24 0 Left 0
SYMATTR InstName AcousticOutput
SYMATTR Value I=I(V_SumAOSensor)
SYMBOL bi -352 480 R180
WINDOW 0 24 88 Left 0
WINDOW 3 24 0 Left 0
WINDOW 39 24 -28 Left 0
SYMATTR InstName Cone_Excursion_mm
SYMATTR Value I=2.828*1000*I(V_uSensor)
SYMATTR SpiceLine laplace=1/s
SYMBOL ind -208 -512 R90
WINDOW 0 5 56 VBottom 0
WINDOW 3 32 56 VTop 0
SYMATTR InstName Mab1_
SYMATTR Value {Mab1}
SYMBOL cap -320 -352 R180
WINDOW 0 24 64 Left 0
WINDOW 3 24 8 Left 0
SYMATTR InstName Cab1_
SYMATTR Value {Cab1}
SYMBOL res -448 -448 M0
SYMATTR InstName RairLeak1_
SYMATTR Value {RairLeak1}
SYMBOL voltage 96 -208 R90
WINDOW 0 -36 28 VBottom 0
WINDOW 3 32 56 VTop 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V_WNearVUSensor
SYMATTR Value ""
SYMATTR Value2 AC 0
SYMBOL voltage -608 -208 M90
WINDOW 0 -32 56 VBottom 0
WINDOW 3 32 56 VTop 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V_P1VUSensor
SYMATTR Value ""
SYMATTR Value2 AC 0
SYMBOL voltage -784 -208 M90
WINDOW 0 -32 29 VBottom 0
WINDOW 3 32 56 VTop 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V_P1NearVUSensor
SYMATTR Value ""
SYMATTR Value2 AC 0
SYMBOL ind -480 -512 R90
WINDOW 0 5 56 VBottom 0
WINDOW 3 32 56 VTop 0
SYMATTR InstName Map1_
SYMATTR Value {Map1}
SYMBOL cap -736 -480 M0
SYMATTR InstName Ca1P1_
SYMATTR Value {Ca1P1}
SYMBOL ind -864 -432 M0
SYMATTR InstName Ma1P1_
SYMATTR Value {Ma1P1}
SYMBOL res -608 -512 M0
SYMATTR InstName Ra1P1_
SYMATTR Value {Ra1P1}
SYMBOL res -608 -384 M0
SYMATTR InstName Ra2P_
SYMATTR Value {Ra2P1}
SYMBOL bi 400 240 R180
WINDOW 0 24 88 Left 0
WINDOW 3 24 0 Left 0
WINDOW 39 24 -28 Left 0
SYMATTR InstName Port1Output
SYMATTR Value I=9390.14*I(V_P1VUSensor)
SYMATTR SpiceLine laplace=s
SYMBOL bi 48 224 R180
WINDOW 0 24 88 Left 0
WINDOW 3 24 0 Left 0
WINDOW 39 24 -28 Left 0
SYMATTR InstName WooferOutput
SYMATTR Value I=9390.14*I(V_WVUSensor)
SYMATTR SpiceLine laplace=s
SYMBOL f -1024 -336 R180
WINDOW 0 24 88 Left 0
WINDOW 3 24 0 Invisible 0
SYMATTR InstName kp1Uw
SYMATTR Value V_WNearVUSensor
SYMATTR Value2 {3*pi*RadP1/(16*DistW_P1)}
SYMBOL f 272 -336 M180
WINDOW 0 24 88 Left 0
WINDOW 3 24 0 Invisible 0
SYMATTR InstName kwUp1
SYMATTR Value V_P1NearVUSensor
SYMATTR Value2 {3*pi*Rad/(16*DistW_P1)}
SYMBOL ind -320 -112 M90
WINDOW 0 5 56 VBottom 0
WINDOW 3 32 56 VTop 0
SYMATTR InstName Map2_
SYMATTR Value {Map2}
SYMBOL cap -384 48 M180
WINDOW 0 24 64 Left 0
WINDOW 3 24 8 Left 0
SYMATTR InstName Cab2_
SYMATTR Value {Cab2}
SYMBOL res -416 -48 M0
SYMATTR InstName RairLeak2_
SYMATTR Value {RairLeak2}
SYMBOL voltage -608 192 M90
WINDOW 0 -32 56 VBottom 0
WINDOW 3 32 56 VTop 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V_P3VUSensor
SYMATTR Value ""
SYMATTR Value2 AC 0
SYMBOL voltage -784 192 M90
WINDOW 0 -32 29 VBottom 0
WINDOW 3 32 56 VTop 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V_P3NearVUSensor
SYMATTR Value ""
SYMATTR Value2 AC 0
SYMBOL ind -480 -112 R90
WINDOW 0 5 56 VBottom 0
WINDOW 3 32 56 VTop 0
SYMATTR InstName Map3_
SYMATTR Value {Map3}
SYMBOL cap -736 -80 M0
SYMATTR InstName Ca1P3_
SYMATTR Value {Ca1P3}
SYMBOL ind -864 -32 M0
SYMATTR InstName Ma1P3_
SYMATTR Value {Ma1P3}
SYMBOL res -608 -112 M0
SYMATTR InstName Ra1P3_
SYMATTR Value {Ra1P3}
SYMBOL res -608 16 M0
SYMATTR InstName Ra2P3_
SYMATTR Value {Ra2P3}
SYMBOL f -1024 64 R180
WINDOW 0 24 88 Left 0
WINDOW 3 24 0 Invisible 0
SYMATTR InstName kp3Uw
SYMATTR Value V_WNearVUSensor
SYMATTR Value2 {3*pi*RadP3/(16*DistW_P3)}
SYMBOL f -1104 -240 R180
WINDOW 0 24 88 Left 0
WINDOW 3 24 0 Invisible 0
SYMATTR InstName kp1Up3
SYMATTR Value V_P3NearVUSensor
SYMATTR Value2 {3*pi*RadP1/(16*DistP1_P3)}
SYMBOL f -1104 144 R180
WINDOW 0 24 88 Left 0
WINDOW 3 24 0 Invisible 0
SYMATTR InstName kp3Up1
SYMATTR Value V_P1NearVUSensor
SYMATTR Value2 {3*pi*RadP3/(16*DistP1_P3)}
SYMBOL f 352 -272 M180
WINDOW 0 24 88 Left 0
WINDOW 3 24 0 Invisible 0
SYMATTR InstName kwUp3
SYMATTR Value V_P3NearVUSensor
SYMATTR Value2 {3*pi*Rad/(16*DistW_P3)}
SYMBOL bi 208 400 R180
WINDOW 0 24 88 Left 0
WINDOW 3 24 0 Left 0
WINDOW 39 24 -28 Left 0
SYMATTR InstName Port3Output
SYMATTR Value I=9390.14*I(V_P3VUSensor)
SYMATTR SpiceLine laplace=s
SYMBOL voltage 192 48 R180
WINDOW 0 -117 9 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V_SumAOSensor
SYMATTR Value ""
SYMATTR Value2 AC 0
SYMBOL voltage -464 -320 R0
WINDOW 39 0 0 Left 0
SYMATTR InstName V_VULeak1
SYMATTR Value ""
SYMATTR Value2 AC 0
SYMBOL bi 384 496 R180
WINDOW 0 24 88 Left 0
WINDOW 3 24 0 Left 0
WINDOW 39 24 -28 Left 0
SYMATTR InstName Leak1Output
SYMATTR Value I=9390.14*I(V_VULeak1)
SYMATTR SpiceLine laplace=s
SYMBOL bi 48 560 R180
WINDOW 0 24 88 Left 0
WINDOW 3 24 0 Left 0
WINDOW 39 24 -28 Left 0
SYMATTR InstName Leak2Output
SYMATTR Value I=9390.14*I(V_VULeak2)
SYMATTR SpiceLine laplace=s
SYMBOL voltage -432 80 R0
WINDOW 39 0 0 Left 0
SYMATTR InstName V_VULeak2
SYMATTR Value ""
SYMATTR Value2 AC 0
TEXT -1610 -742 Left 0 !.ac oct 40 10 2000
TEXT -1960 272 Left 0 !.param Bl={sqrt(Re*sqrt(Mms/Cms)/Qe)}
TEXT -2216 -744 Left 0 !.param Mms=17.7e-3
TEXT -1960 176 Left 0 !.param Mmd={Mms-(16*Sd*Sd*1.18/(3*rad*pi*pi))}
TEXT -2216 -712 Left 0 !.param Sd=134e-4
TEXT -1960 144 Left 0 !.param rad={sqrt(Sd/pi)}
TEXT -2216 -680 Left 0 !.param Fs=52.3
TEXT -1960 240 Left 0 !.param Rms={sqrt(Mms/Cms)/Qms}
TEXT -1960 208 Left 0 !.param Cms={1/(pow(Fs*2*pi,2)*Mms)}
TEXT -2216 -648 Left 0 !.param Qms=2.79
TEXT -2216 -616 Left 0 !.param Qe=0.5
TEXT -2216 -584 Left 0 !.param Re=5.8
TEXT -2216 -552 Left 0 !.param Le=0.2m
TEXT -2216 -520 Left 0 !.param Lep=0.1m
TEXT -2216 -488 Left 0 !.param Rep=5
TEXT -1960 304 Left 0 !.param Ma1={8*1.18/(3*pi*pi*rad)}
TEXT -1960 336 Left 0 !.param Ra1={0.441*1.18*345/Sd}
TEXT -1960 368 Left 0 !.param Ra2={1.18*345/Sd}
TEXT -1960 400 Left 0 !.param Ca1={5.94*pow(rad,3)/(1.18*345*345)}
TEXT -2224 152 Left 0 ;Calculated parameters:
TEXT -2216 -808 Left 0 ;Edit the values of the following driver parameters:\n(Le, Lep and Rep are optional)
TEXT -1152 328 Left 0 ;Outputs to be plotted:\n(Vc impedance is V(in)/I(Re_)\nand group delay is plotted\nat AcousticOutput's plot
TEXT -2216 -424 Left 0 ;Edit the box parameters, Vb1 is volume that driver works into,\n Vb2 is second chamber volume, P1 is port that opens to baffle inside Vb1, \nP2 is the port that connects two Vb1 to Vb2, P3 is the port that opens to baffle \nfrom Vb2 (all in meters and m3):
TEXT -2216 -312 Left 0 !.param Vb1=14e-3
TEXT -1960 432 Left 0 !.param Cab1={Vb1/(1.18*345*345)}
TEXT -1960 560 Left 0 !.param SP1={pi*RadP1*RadP1}\n.param Ma1p1={8*1.18/(3*pi*pi*RadP1)}\n.param Map1={(1.18/SP1)*(LP1+0.6132*sqrt(SP1/pi))}\n.param Fb1={1/(2*pi*sqrt(Cab1*(Map1+Ma1P1)))}\n.param RairLeak1={QL1/(2*pi*Fb1*Cab1)}\n.param Ra2P1={1.18*345/(SP1)}\n.param Ra1P1={0.441*1.18*345/(SP1)}\n.param Ca1P1={5.94*pow(RadP1,3)/(1.18*345*345)}
TEXT -2216 -288 Left 0 !.param Ql1=7
TEXT -2216 -184 Left 0 !.param RadP1=2.5e-2
TEXT -1960 464 Left 0 !.param Vas={1.18*pow(345*Sd,2)*Cms}
TEXT -1960 528 Left 0 !.param Mab1=0.65*2.0/(pi*rad)
TEXT -1136 -856 Left 0 ;Use following step to try step changing box params:\n.step param Vb 10e-3 20e-3 4e-3
TEXT -1920 496 Left 0 ;For Mab, use 0.65*2...  to account for some filling used:
TEXT -696 640 Left 0 !.measure BoxTuningFreqFb1 Param pow(10, Fb1/20)\n.measure BoxTuningFreqFb2 Param pow(10, Fb2/20)
TEXT -2216 -208 Left 0 !.param LP1=0.13
TEXT -2216 16 Left 0 !.param DistW_P1=0.5\n.param DistW_P3=0.7\n.param DistP1_P3=0.15
TEXT -2184 -40 Left 0 ;Distances between ports and woofer opening, for mutual radiation.\nMake these very high for ignoring this: (as everything else in meters):
TEXT -2080 -952 Left 0 ;This DualChamberPorted2 model uses port lengths (LP1,LP2,LP3) instead of \nFbs as design input. LP is supposed to be the real length of a port used, \n\nexcluding any correction length at ends. The end corrections are accounted \nfor in the calculations below.
TEXT -1024 664 Left 0 ;Printed Values at Output Log:
TEXT -2216 -264 Left 0 !.param Vb2=7e-3\n.param Ql2=7
TEXT -2216 -152 Left 0 !.param LP2=0.13\n.param RadP2=2.5e-2\n.param LP3=0.13\n.param RadP3=2.5e-2
TEXT -1960 784 Left 0 !.param SP2=pi*RadP2*RadP2\n.param Map2=(1.18/SP2)*(LP2+1.462*sqrt(SP2/pi))\n.param Cab2={Vb2/(1.18*345*345)}\n.param FB2={1/(2*pi*sqrt(Cab2*(Map3+Ma1P3)))}\n.param RairLeak2={Ql2/(2*pi*FB2*Cab2)}
TEXT -1960 928 Left 0 !.param SP3=pi*RadP3*RadP3\n.param Map3=(1.18/SP3)*(LP3+0.6132*sqrt(SP3/pi))\n.param Ra2P3={1.18*345/(SP3)}\n.param Ra1P3={0.441*1.18*345/(SP3)}\n.param Ca1P3={5.94*pow(RadP3,3)/(1.18*345*345)}\n.param Ma1p3={8*1.18/(3*pi*pi*RadP3)}
