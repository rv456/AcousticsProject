* C:\From Compaq\My Documents\Hobby\Speakers\Designs\SpeakerSPICEModels\DualChamberPorted2.asc
Vin N001 0 AC 2.828 0
Re_ P001 In {Re}
Le_ N002 P001 {Le}
V_Isensor N004 0 AC 0
H§BLu N003 N004 V_uSensor {Bl}
H§Bli N009 0 V_ISensor {BL}
L§Mmd_ N010 N009 {Mmd}
Rms_ N011 N010 {Rms}
Cms_ N014 N011 {Cms}
E§SdPd N014 N015 Pf Pb {Sd}
V_uSensor N015 0 AC 0
F§Sdu Pb Pf V_uSensor {Sd}
Ra1_ Pf N022 {Ra1}
Ra2_ N022 N023 {Ra2}
Ca1_ Pf N022 {Ca1}
L§Ma1_ Pf N025 {Ma1}
Lep_ N003 N002 {Lep}
Rep_ N002 N003 {Rep}
Rsource N001 In 0.1
V_WVUSensor N023 0 AC 0
B§AcousticOutput 0 0 I=I(V_SumAOSensor)
B§Cone_Excursion_mm 0 0 I=2.828*1000*I(V_uSensor) laplace=1/s
L§Mab1_ Pb N018 {Mab1}
Cab1_ 0 N018 {Cab1}
RairLeak1_ N018 N019 {RairLeak1}
V_WNearVUSensor N025 N023 AC 0
V_P1VUSensor N016 0 AC 0
V_P1NearVUSensor N006 N016 AC 0
L§Map1_ N018 N005 {Map1}
Ca1P1_ N005 N012 {Ca1P1}
L§Ma1P1_ N005 N006 {Ma1P1}
Ra1P1_ N005 N012 {Ra1P1}
Ra2P_ N012 N016 {Ra2P1}
B§Port1Output 0 N024 I=9390.14*I(V_P1VUSensor) laplace=s
B§WooferOutput 0 N024 I=9390.14*I(V_WVUSensor) laplace=s
F§kp1Uw N006 N005 V_WNearVUSensor {3*pi*RadP1/(16*DistW_P1)}
F§kwUp1 N025 Pf V_P1NearVUSensor {3*pi*Rad/(16*DistW_P1)}
L§Map2_ N020 N018 {Map2}
Cab2_ 0 N020 {Cab2}
RairLeak2_ N020 N021 {RairLeak2}
V_P3VUSensor N017 0 AC 0
V_P3NearVUSensor N008 N017 AC 0
L§Map3_ N020 N007 {Map3}
Ca1P3_ N007 N013 {Ca1P3}
L§Ma1P3_ N007 N008 {Ma1P3}
Ra1P3_ N007 N013 {Ra1P3}
Ra2P3_ N013 N017 {Ra2P3}
F§kp3Uw N008 N007 V_WNearVUSensor {3*pi*RadP3/(16*DistW_P3)}
F§kp1Up3 N006 N005 V_P3NearVUSensor {3*pi*RadP1/(16*DistP1_P3)}
F§kp3Up1 N008 N007 V_P1NearVUSensor {3*pi*RadP3/(16*DistP1_P3)}
F§kwUp3 N025 Pf V_P3NearVUSensor {3*pi*Rad/(16*DistW_P3)}
B§Port3Output 0 N024 I=9390.14*I(V_P3VUSensor) laplace=s
V_SumAOSensor N024 0 AC 0
V_VULeak1 N019 0 AC 0
B§Leak1Output 0 N024 I=9390.14*I(V_VULeak1) laplace=s
B§Leak2Output 0 N024 I=9390.14*I(V_VULeak2) laplace=s
V_VULeak2 N021 0 AC 0
.ac oct 40 10 2000
.param Bl={sqrt(Re*sqrt(Mms/Cms)/Qe)}
.param Mms=17.7e-3
.param Mmd={Mms-(16*Sd*Sd*1.18/(3*rad*pi*pi))}
.param Sd=134e-4
.param rad={sqrt(Sd/pi)}
.param Fs=52.3
.param Rms={sqrt(Mms/Cms)/Qms}
.param Cms={1/(pow(Fs*2*pi,2)*Mms)}
.param Qms=2.79
.param Qe=0.5
.param Re=5.8
.param Le=0.2m
.param Lep=0.1m
.param Rep=5
.param Ma1={8*1.18/(3*pi*pi*rad)}
.param Ra1={0.441*1.18*345/Sd}
.param Ra2={1.18*345/Sd}
.param Ca1={5.94*pow(rad,3)/(1.18*345*345)}
* Calculated parameters:
* Edit the values of the following driver parameters:\n(Le, Lep and Rep are optional)
* Outputs to be plotted:\n(Vc impedance is V(in)/I(Re_)\nand group delay is plotted\nat AcousticOutput's plot
* Edit the box parameters, Vb1 is volume that driver works into,\n Vb2 is second chamber volume, P1 is port that opens to baffle inside Vb1, \nP2 is the port that connects two Vb1 to Vb2, P3 is the port that opens to baffle \nfrom Vb2 (all in meters and m3):
.param Vb1=14e-3
.param Cab1={Vb1/(1.18*345*345)}
.param SP1={pi*RadP1*RadP1}
.param Ma1p1={8*1.18/(3*pi*pi*RadP1)}
.param Map1={(1.18/SP1)*(LP1+0.6132*sqrt(SP1/pi))}
.param Fb1={1/(2*pi*sqrt(Cab1*(Map1+Ma1P1)))}
.param RairLeak1={QL1/(2*pi*Fb1*Cab1)}
.param Ra2P1={1.18*345/(SP1)}
.param Ra1P1={0.441*1.18*345/(SP1)}
.param Ca1P1={5.94*pow(RadP1,3)/(1.18*345*345)}
.param Ql1=7
.param RadP1=2.5e-2
.param Vas={1.18*pow(345*Sd,2)*Cms}
.param Mab1=0.65*2.0/(pi*rad)
* Use following step to try step changing box params:\n.step param Vb 10e-3 20e-3 4e-3
* For Mab, use 0.65*2...  to account for some filling used:
.measure BoxTuningFreqFb1 Param pow(10, Fb1/20)
.measure BoxTuningFreqFb2 Param pow(10, Fb2/20)
.param LP1=0.13
.param DistW_P1=0.5
.param DistW_P3=0.7
.param DistP1_P3=0.15
* Distances between ports and woofer opening, for mutual radiation.\nMake these very high for ignoring this: (as everything else in meters):
* This DualChamberPorted2 model uses port lengths (LP1,LP2,LP3) instead of \nFbs as design input. LP is supposed to be the real length of a port used, \n\nexcluding any correction length at ends. The end corrections are accounted \nfor in the calculations below.
* Printed Values at Output Log:
.param Vb2=7e-3
.param Ql2=7
.param LP2=0.13
.param RadP2=2.5e-2
.param LP3=0.13
.param RadP3=2.5e-2
.param SP2=pi*RadP2*RadP2
.param Map2=(1.18/SP2)*(LP2+1.462*sqrt(SP2/pi))
.param Cab2={Vb2/(1.18*345*345)}
.param FB2={1/(2*pi*sqrt(Cab2*(Map3+Ma1P3)))}
.param RairLeak2={Ql2/(2*pi*FB2*Cab2)}
.param SP3=pi*RadP3*RadP3
.param Map3=(1.18/SP3)*(LP3+0.6132*sqrt(SP3/pi))
.param Ra2P3={1.18*345/(SP3)}
.param Ra1P3={0.441*1.18*345/(SP3)}
.param Ca1P3={5.94*pow(RadP3,3)/(1.18*345*345)}
.param Ma1p3={8*1.18/(3*pi*pi*RadP3)}
.backanno
.end
